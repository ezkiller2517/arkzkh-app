build:
  steps:
    - name: fetch
      fetch:
        repo: .  # required; fetches your workspace

    - name: npm-install
      npm:
        install:
          directory: .

    - name: npm-build
      npm:
        run:
          script: build
          directory: .

  # Tell Firebase where Next puts the server bundle
  output:
    directory: .next

runConfig:
  runtime: nodejs20
  workingDirectory: .
  env:
    - key: PORT
      value: "${PORT}"
